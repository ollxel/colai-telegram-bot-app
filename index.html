<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Neural Collaborative Framework</title>
    <link rel="stylesheet" href="styles.css">
    <script type="importmap">
    {
        "imports": {
            "marked": "https://cdn.jsdelivr.net/npm/marked@5.0.2/lib/marked.esm.js"
        }
    }
    </script>
</head>
<body>
    <div class="container">
        <header>
            <h1>Neural Collaborative Framework</h1>
            <div class="description">
                <p>A collaborative framework where neural networks work together through iterative dialogue on any topic.</p>
            </div>
            <div class="mode-selector">
                <a href="#" class="mode-link active">Collaboration Mode</a>
                <a href="#mafia" class="mode-link">Mafia Game Mode</a>
                <a href="#wiki" class="mode-link">Wiki</a>
            </div>
        </header>

        <div class="framework-container">
            <div class="control-panel">
                <h2>Project Setup</h2>
                <div class="form-group">
                    <label for="project-name">Project Name:</label>
                    <input type="text" id="project-name" placeholder="Enter project name">
                </div>
                <div class="form-group">
                    <label for="project-description">Project Description:</label>
                    <textarea id="project-description" placeholder="Describe the software application you want to build"></textarea>
                </div>
                <div class="form-group">
                    <label for="file-attachments">Attach Files:</label>
                    <div class="file-upload-container">
                        <input type="file" id="file-attachments" multiple class="file-input">
                        <label for="file-attachments" class="file-upload-btn">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                                <path d="M8 0a5.53 5.53 0 0 0-3.594 1.342c-.766.66-1.321 1.52-1.464 2.383C1.266 4.095 0 5.555 0 7.318 0 9.366 1.708 11 3.781 11H7.5V5.5a.5.5 0 0 1 1 0V11h4.188C14.502 11 16 9.57 16 7.773c0-1.636-1.242-2.969-2.834-3.194C12.923 1.999 10.69 0 8 0zm-.354 15.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 14.293V11h-1v3.293l-2.146-2.147a.5.5 0 0 0-.708.708l3 3z"/>
                            </svg>
                            Choose Files
                        </label>
                    </div>
                    <div id="attachment-preview" class="attachment-preview"></div>
                </div>
                <div class="form-group">
                    <label for="summarizer-instructions">Summarizer Instructions:</label>
                    <textarea id="summarizer-instructions" placeholder="Custom instructions for the Synthesizer Network (optional)"></textarea>
                </div>
                
                <div class="form-group">
                    <label for="max-iterations">Maximum Iterations:</label>
                    <div class="iterations-input-container">
                        <input type="number" id="max-iterations-input" min="1" max="100" value="5" class="number-input">
                        <div class="slider-container">
                            <input type="range" id="max-iterations" min="1" max="20" value="5" class="slider">
                            <span id="iteration-value">5</span>
                        </div>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="discussion-rounds">Discussion rounds:</label>
                    <input type="number" id="discussion-rounds" min="1" max="10" value="1">
                </div>
                <div class="form-group">
                    <label class="checkbox-label" for="infinite-mode">
                        <input type="checkbox" id="infinite-mode">
                        Enable Infinite Discussion Mode
                    </label>
                    <div class="network-description">Never-ending conversation - networks will continue discussing until manually stopped</div>
                </div>
                <div class="form-group">
                    <label for="interface-language">Interface Language:</label>
                    <select id="interface-language">
                        <option value="en">English</option>
                        <option value="ru">Русский</option>
                        <option value="es">Español</option>
                        <option value="fr">Français</option>
                        <option value="de">Deutsch</option>
                        <option value="it">Italiano</option>
                        <option value="pt">Português</option>
                        <option value="zh">中文</option>
                        <option value="ja">日本語</option>
                        <option value="ko">한국어</option>
                        <option value="ar">العربية</option>
                        <option value="hi">हिन्दी</option>
                        <option value="tr">Türkçe</option>
                        <option value="pl">Polski</option>
                        <option value="nl">Nederlands</option>
                        <option value="sv">Svenska</option>
                        <option value="da">Dansk</option>
                        <option value="no">Norsk</option>
                        <option value="fi">Suomi</option>
                        <option value="cs">Čeština</option>
                        <option value="sk">Slovenčina</option>
                        <option value="hu">Magyar</option>
                        <option value="ro">Română</option>
                        <option value="bg">Български</option>
                        <option value="hr">Hrvatski</option>
                        <option value="sr">Српски</option>
                        <option value="sl">Slovenščina</option>
                        <option value="et">Eesti</option>
                        <option value="lv">Latviešu</option>
                        <option value="lt">Lietuvių</option>
                        <option value="el">Ελληνικά</option>
                        <option value="he">עברית</option>
                        <option value="th">ไทย</option>
                        <option value="vi">Tiếng Việt</option>
                        <option value="id">Bahasa Indonesia</option>
                        <option value="ms">Bahasa Melayu</option>
                        <option value="tl">Filipino</option>
                        <option value="sw">Kiswahili</option>
                        <option value="zu">isiZulu</option>
                        <option value="af">Afrikaans</option>
                        <option value="am">አማርኛ</option>
                        <option value="bn">বাংলা</option>
                        <option value="gu">ગુજરાતી</option>
                        <option value="kn">ಕನ್ನಡ</option>
                        <option value="ml">മലയാളം</option>
                        <option value="mr">मराठी</option>
                        <option value="pa">ਪੰਜਾਬੀ</option>
                        <option value="ta">தமிழ்</option>
                        <option value="te">తెలుగు</option>
                        <option value="ur">اردو</option>
                        <option value="fa">فارسی</option>
                        <option value="ps">پښتو</option>
                        <option value="ky">Кыргызча</option>
                        <option value="kk">Қазақша</option>
                        <option value="uz">O'zbekcha</option>
                        <option value="tg">Тоҷикӣ</option>
                        <option value="mn">Монгол</option>
                        <option value="my">မြန်မာ</option>
                        <option value="km">ខ្មែរ</option>
                        <option value="lo">ລາວ</option>
                        <option value="si">සිංහල</option>
                        <option value="ne">नेपाली</option>
                        <option value="dz">རྫོང་ཁ</option>
                        <option value="bo">བོད་སྐད་</option>
                    </select>
                </div>
                <button id="toggle-player-settings" class="settings-toggle">Player Settings</button>
                <div class="model-settings">
                    <h3>Model Settings <button id="toggle-settings" class="toggle-btn">Show</button></h3>
                    <div id="advanced-settings" class="advanced-settings">
                        <div class="form-group">
                            <label for="system-prompt">System Prompt Template:</label>
                            <textarea id="system-prompt" placeholder="Customize the system prompt for networks"></textarea>
                        </div>
                        <div class="form-group">
                            <label for="api-keys">API Keys Configuration:</label>
                            <button id="manage-api-keys" class="btn btn-secondary">Manage API Keys</button>
                        </div>
                        <div class="form-group">
                            <label for="iteration-type">Iteration Determination:</label>
                            <select id="iteration-type">
                                <option value="auto">Automatic (Standard)</option>
                                <option value="custom">Custom Cycle Definition</option>
                            </select>
                        </div>
                        <div class="form-group" id="custom-iteration-container" style="display:none;">
                            <label for="custom-iteration-cycles">Custom Cycle Count:</label>
                            <input type="number" id="custom-iteration-cycles" min="1" max="10" value="1">
                        </div>
                        <div class="form-group">
                            <label for="temperature">Temperature:</label>
                            <div class="slider-container">
                                <input type="range" id="temperature" min="0" max="20" value="7" class="slider" step="1">
                                <span id="temperature-value">0.7</span>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="max-tokens">Max Tokens:</label>
                            <div class="slider-container">
                                <input type="range" id="max-tokens" min="100" max="2000" value="1000" class="slider" step="100">
                                <span id="tokens-value">1000</span>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="top-p">Top P:</label>
                            <div class="slider-container">
                                <input type="range" id="top-p" min="0" max="10" value="10" class="slider" step="1">
                                <span id="top-p-value">1.0</span>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="presence-penalty">Presence Penalty:</label>
                            <div class="slider-container">
                                <input type="range" id="presence-penalty" min="-20" max="20" value="0" class="slider" step="1">
                                <span id="presence-penalty-value">0.0</span>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="frequency-penalty">Frequency Penalty:</label>
                            <div class="slider-container">
                                <input type="range" id="frequency-penalty" min="-20" max="20" value="0" class="slider" step="1">
                                <span id="frequency-penalty-value">0.0</span>
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="checkbox-label" for="use-network1">
                                <input type="checkbox" id="use-network1" checked>
                                Enable Analytical Network (Network 1)
                            </label>
                            <div class="network-description">Focuses on critical analysis and structured thinking</div>
                        </div>
                        <div class="form-group">
                            <label class="checkbox-label" for="use-network2">
                                <input type="checkbox" id="use-network2" checked>
                                Enable Creative Network (Network 2)
                            </label>
                            <div class="network-description">Focuses on creative thinking and innovative perspectives</div>
                        </div>
                        <div class="form-group">
                            <label class="checkbox-label" for="use-network3">
                                <input type="checkbox" id="use-network3">
                                Enable Third Network (Implementation Network)
                            </label>
                            <div class="network-description">Adds a third network focused on practical implementation and technical feasibility</div>
                        </div>
                        <div class="form-group">
                            <label class="checkbox-label" for="use-network4">
                                <input type="checkbox" id="use-network4">
                                Enable Fourth Network (Data Science Network)
                            </label>
                            <div class="network-description">Adds a network focused on data analysis and empirical evidence</div>
                        </div>
                        <div class="form-group">
                            <label class="checkbox-label" for="use-network5">
                                <input type="checkbox" id="use-network5">
                                Enable Fifth Network (Ethical Network)
                            </label>
                            <div class="network-description">Adds a network focused on ethical considerations and societal impact</div>
                        </div>
                        <div class="form-group">
                            <label class="checkbox-label" for="use-network6">
                                <input type="checkbox" id="use-network6">
                                Enable Sixth Network (User Experience Network)
                            </label>
                            <div class="network-description">Adds a network focused on user-centered design and experience</div>
                        </div>
                        <div class="form-group">
                            <label class="checkbox-label" for="use-network7">
                                <input type="checkbox" id="use-network7">
                                Enable Seventh Network (Systems Thinking Network)
                            </label>
                            <div class="network-description">Adds a network focused on holistic view and interconnections</div>
                        </div>
                        <div class="form-group">
                            <label class="checkbox-label" for="use-network8">
                                <input type="checkbox" id="use-network8">
                                Enable Eighth Network (Devil's Advocate Network)
                            </label>
                            <div class="network-description">Adds a network that critically challenges and stress-tests ideas</div>
                        </div>
                        <div class="form-group">
                            <label for="logit-bias">Logit Bias:</label>
                            <textarea id="logit-bias" placeholder="Optional JSON format token biases, e.g. {'123': 10, '456': -5}"></textarea>
                            <div class="network-description">Modify token probabilities during generation (advanced)</div>
                        </div>
                        <div class="form-group">
                            <button id="add-network" class="btn btn-secondary">Add New Network</button>
                            <div class="network-description">Add a custom network with specialized capabilities</div>
                        </div>
                    </div>
                </div>
                
                <button id="start-discussion" class="btn">Start Collaboration</button>
                <button id="reset-project" class="btn btn-secondary">Reset Project</button>
                
                <div class="iterations-display">
                    <h3>Iteration Progress</h3>
                    <div class="iteration-count">Iterations: <span id="iteration-counter">0</span></div>
                    <div class="accepted-summaries">
                        <h4>Accepted Summaries</h4>
                        <ul id="summary-list"></ul>
                    </div>
                </div>
            </div>

            <div class="discussion-area">
                <div class="chat-container">
                    <div class="chat-header">
                        <h2>Development Dialogue</h2>
                        <button id="pause-discussion" class="pause-btn" style="display: none;">Pause Discussion</button>
                        <div class="network-status">
                            <div class="status-indicator active" id="network1-status">
                                <span class="status-dot"></span>
                                <span class="status-name">Network 1</span>
                            </div>
                            <div class="status-indicator" id="network2-status">
                                <span class="status-dot"></span>
                                <span class="status-name">Network 2</span>
                            </div>
                            <div class="status-indicator" id="network3-status" style="display: none;">
                                <span class="status-dot"></span>
                                <span class="status-name">Network 3</span>
                            </div>
                            <div class="status-indicator" id="network4-status" style="display: none;">
                                <span class="status-dot"></span>
                                <span class="status-name">Network 4</span>
                            </div>
                            <div class="status-indicator" id="network5-status" style="display: none;">
                                <span class="status-dot"></span>
                                <span class="status-name">Network 5</span>
                            </div>
                            <div class="status-indicator" id="network6-status" style="display: none;">
                                <span class="status-dot"></span>
                                <span class="status-name">Network 6</span>
                            </div>
                            <div class="status-indicator" id="network7-status" style="display: none;">
                                <span class="status-dot"></span>
                                <span class="status-name">Network 7</span>
                            </div>
                            <div class="status-indicator" id="network8-status" style="display: none;">
                                <span class="status-dot"></span>
                                <span class="status-name">Network 8</span>
                            </div>
                            <div class="status-indicator" id="summarizer-status">
                                <span class="status-dot"></span>
                                <span class="status-name">Summarizer</span>
                            </div>
                        </div>
                    </div>
                    <div class="chat-messages" id="chat-messages">
                        <!-- Messages will be added here via JavaScript -->
                    </div>
                    <div class="user-input-area" id="user-input-area" style="display: none;">
                        <textarea id="user-prompt" placeholder="Enter your prompt or instructions here..."></textarea>
                        <div class="user-input-buttons">
                            <button id="submit-user-prompt" class="btn">Submit</button>
                            <button id="cancel-user-prompt" class="btn btn-secondary">Cancel</button>
                        </div>
                    </div>
                </div>
                
                <!-- Stream interface will be added here by JavaScript -->
                
                <div class="output-panel">
                    <h2>Development Output</h2>
                    <div class="final-output" id="final-output">
                        <p class="placeholder">The finalized application details will appear here after collaboration is complete.</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <button id="theme-toggle" class="theme-toggle" aria-label="Toggle dark/light mode">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="sun-icon">
            <circle cx="12" cy="12" r="5"></circle>
            <line x1="12" y1="1" x2="12" y2="3"></line>
            <line x1="12" y1="21" x2="12" y2="23"></line>
            <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
            <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
            <line x1="1" y1="12" x2="3" y2="12"></line>
            <line x1="21" y1="12" x2="23" y2="12"></line>
            <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
            <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
        </svg>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="moon-icon" style="display: none;">
            <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
        </svg>
    </button>

    <script src="app.js" type="module"></script>
</body>
</html>